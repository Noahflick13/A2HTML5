(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{I3Uf:function(e,t,a){e.exports={registrationContainer:"registrationContainer__2QEroVip0rj6VbrALiBz8V",registrationContainerCompact:"registrationContainerCompact__3dLlGm-Ygzwm1cLpI2SAvM",screenReaderOnly:"screenReaderOnly__1DEYZ8Nk3P95bk8hyfMxBS",submitButton:"submitButton__34k4InI5TII_ayjcKIwCLO",submitButtonCompact:"submitButtonCompact__2kcHUFS16OCjvIlCGzr4XY",tos:"tos__2irFvmVYzLt-zbObC3_2D8",fieldset:"fieldset__90L8T9R_uCnS1Uv2DXnSl",formCompact:"formCompact__1SC_7CLTtI-fJ7tbhKNBS_",formGroupsCompact:"formGroupsCompact__1XRxvXwGwE31DG6oB_6E4s",formGroupCompact:"formGroupCompact__3-5L2PXwpuSeLv70_XgwCi",inputCompact:"inputCompact__2utnVUMiZ3IfcJ0d31pVhN",validCheckmark:"validCheckmark__1dZPYK1Ez-la0tynqyu1Fg",inputWrapper:"inputWrapper__1QrvHYrz5fvfSM_ybUnPYg",hidden:"hidden__1Fl8d9j8OjxIV9JmE_eJdl",recaptchaError:"recaptchaError__1Bv_glx_hCOObzHUb3cF9b",formGroup:"formGroup__2f7GlHvZXKIMvaIzaJuPIp",padBottomIfNotEmpty:"padBottomIfNotEmpty__1nV3QG5IEzhRlwpmTjvFiE"}},NosH:function(e,t,a){"use strict";var r=a("Z0cm"),n=a.n(r),i=a("mwIZ"),o=a.n(i),s=a("DzJC"),c=a.n(s),l=a("q1tI"),u=a.n(l),d=a("17x9"),p=a.n(d),f=a("24Ii"),m=a.n(f),b=a("qVvP"),y=a("xk4V"),_=a.n(y),h=a("USFT"),v=a("TSYQ"),g=a.n(v),S=a("JD0t"),E=a("2F30"),C=a("oNLn"),P=a("rIqd"),O=a("Gtit"),w=a("DPuV"),j=a("jdWZ"),F=a("JDpR"),I=a("PAGU"),k=a("wz8U"),V=a("I3Uf"),R=a.n(V);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){_defineProperty(e,t,a[t])})}return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){var a=[],r=!0,n=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}return a}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var x=[{name:"username",label:Object(h.b)("views.users.registration.username_label"),autocomplete:"username",autofocus:!0,type:"text"},{name:"email",label:Object(h.b)("views.users.registration.email_label"),type:"email",autocomplete:"email",invalidMessage:"Please use a valid email address"},{name:"password",label:Object(h.b)("views.users.registration.password_label"),type:"password",autocomplete:"new-password",invalidMessage:"must have at least 6 characters",pattern:".{6,128}"}],T=function getInputConfig(e){return e?x.filter(function(e){return"username"!==e.name}):x},B="/register/validate",z="/register",N=function extractValidationErrors(e){var t=o()(e,"body.errors");return t&&Object.values(t).filter(function(e){return e})?Object.entries(t).reduce(function(e,t){var a=_slicedToArray(t,2),r=a[0],i=a[1];return _objectSpread({},e,_defineProperty({},r,n()(i)?i[0]:i))},{}):null},U=function(e){function RegistrationForm(){var e,t;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,RegistrationForm);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(t=_possibleConstructorReturn(this,(e=_getPrototypeOf(RegistrationForm)).call.apply(e,[this].concat(r)))).idPrefix="sign_up_form_",t.state={disabled:!1,recaptchaInstanceId:_()(),validationErrors:{},validatedFields:new Set([])},t.onRecapChange=function(e){t.submitForm(e)},t.onRecapExpire=function(){t.resetRecaptcha()},t.onSuccessfulValidation=function(e){t.setValidationErrorState(_defineProperty({},e,void 0)),t.setState(function(t){return{validatedFields:t.validatedFields.add(e)}})},t.onFailedValidation=function(e,a){t.setValidationErrorState(_defineProperty({},e,a)),t.setState(function(t){return t.validatedFields.delete(e),{validatedFields:t.validatedFields}})},t.onSubmissionFailedValidation=function(e){t.setValidationErrorState(e),t.setState(function(a){Object.keys(e).forEach(function(e){a.validatedFields.delete(e)}),t.setState({validatedFields:a.validatedFields})})},t.submitForm=function(e){m.a.post(z).send(_objectSpread({},t.serialize(),{"g-recaptcha-response":e})).use(b.b).accept("json").then(function(e){var a=e.body;Object(j.a)("user_sign_up"),t.setState({disabled:!1}),t.props.onSuccess(a)}).catch(function(e){var a=N(e.response);t.setState({disabled:!1}),a&&t.onSubmissionFailedValidation(a),t.resetRecaptcha()})},t.onSubmitInitialize=function(e){return e.preventDefault(),t.isValid()?(t.setState({disabled:!0}),m.a.post(B).send(t.serialize()).use(b.b).accept("json").then(function(){t.captcha.execute()}).catch(function(e){var a=N(e.response);a&&t.onSubmissionFailedValidation(a),t.setState({disabled:!1})})):null},t.genericClientSideValidityHandler=function(e,a){var r,n=a.target.validity.valueMissing,i=a.target.validity.valid;n?r="can't be blank":i||(r=T(t.props.hideUsername).find(function(t){return t.name===e}).invalidMessage),r?t.onFailedValidation(e,r):t.onSuccessfulValidation(e)},t.genericServerSideValidityHandler=c()(function(e,a){a.target.value?m.a.post(B).send({user:_defineProperty({},e,a.target.value)}).use(b.b).accept("json").then(function(){t.onSuccessfulValidation(e)}).catch(function(a){var r=N(a.response);r[e]?t.onFailedValidation(e,r[e]):t.onSuccessfulValidation(e)}):t.onFailedValidation(e,"can't be blank")},250),t.validateField=function(e,a){"password"===e?t.genericClientSideValidityHandler(a.target.name,a):t.genericServerSideValidityHandler(a.target.name,a)},t.onFieldBlur=function(e){e.persist(),t.validateField(e.target.name,e)},t.onFieldKeyUp=function(e){e.persist();var a=e.target.name;t.state.validationErrors[a]&&t.validateField(e.target.name,e)},t.onSubmitClick=function(){Object(j.e)({target:"create_account"})},t.setFormRef=function(e){t.form=e},t.setCaptchaRef=function(e){t.captcha=e},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(RegistrationForm,l["Component"]),function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}(RegistrationForm,[{key:"setValidationErrorState",value:function setValidationErrorState(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setState(function(a){return _objectSpread({validationErrors:_objectSpread({},a.validationErrors,e)},t)})}},{key:"isValid",value:function isValid(){return!Object.values(this.state.validationErrors).filter(function(e){return e}).length}},{key:"serialize",value:function serialize(){return _toConsumableArray(this.form.elements).filter(function(e){return e.name}).reduce(function(e,t){var a=t.dataset.resource;return _objectSpread({},e,a?_defineProperty({},a,_objectSpread({},e[a],_defineProperty({},t.name,t.value))):_defineProperty({},t.name,t.value))},{allow_blank_username:this.props.hideUsername})}},{key:"resetRecaptcha",value:function resetRecaptcha(){this.setState({recaptchaInstanceId:_()(),disabled:!1})}},{key:"render",value:function render(){var e,t=this,a=k.a.get("authenticity_token"),r=this.props,n=r.redirectUrl,i=r.locationType,o=r.currentPage,s=r.hideRecaptchaInfo,c=r.hideOauth,l=r.hideSubmitButton,d=r.disableFieldset,p=r.theme,f=r.ctaText,m=r.markValidatedFields,b=r.submitButtonProps,y="location/EXERCISE"===i,_=this.state.disabled,v=n&&Object(O.f)(n),w=g()("recaptcha-wrapper",_defineProperty({},R.a.padBottomIfNotEmpty,"compact"!==p));return u.a.createElement("div",{className:g()(R.a.registrationContainer,_defineProperty({},R.a.registrationContainerCompact,"compact"===p))},u.a.createElement("form",{onSubmit:this.onSubmitInitialize,noValidate:!0,ref:this.setFormRef},u.a.createElement("fieldset",{className:R.a.fieldset,disabled:d},u.a.createElement("legend",{className:R.a.screenReaderOnly},"Sign up"),u.a.createElement("input",{name:"authenticity_token",type:"hidden",value:a}),u.a.createElement("input",{name:"signing_up_from_exercise",type:"hidden",value:y}),u.a.createElement("input",{name:"referring_page",type:"hidden",value:o}),u.a.createElement("input",{name:"redirect",type:"hidden",value:v}),u.a.createElement("div",{className:g()(R.a.formGroups,_defineProperty({},R.a.formGroupsCompact,"compact"===p))},T(this.props.hideUsername).map(function(e){return u.a.createElement(S.a,{key:"".concat(t.idPrefix).concat(e.name),htmlFor:"".concat(t.idPrefix).concat(e.name),label:e.label,className:g()(R.a.formGroup,_defineProperty({},R.a.formGroupCompact,"compact"===p)),description:t.state.validationErrors[e.name]},u.a.createElement("div",{className:R.a.inputWrapper},u.a.createElement(E.a,{className:g()(R.a.input,_defineProperty({},R.a.inputCompact,"compact"===p)),"data-testid":"".concat(e.name,"-field"),htmlFor:"".concat(t.idPrefix).concat(e.name),name:e.name,type:e.type,autoComplete:e.autocomplete,onBlur:t.onFieldBlur,onKeyUp:t.onFieldKeyUp,required:!0,error:!!t.state.validationErrors[e.name],pattern:e.pattern,"data-resource":"user",autoFocus:e.autofocus}),m&&t.state.validatedFields.has(e.name)&&u.a.createElement(C.a,{name:"checkmark",className:R.a.validCheckmark})))})),u.a.createElement("div",{className:w},this.state.validationErrors.recaptcha&&u.a.createElement("div",{className:R.a.recaptchaError,"data-testid":"recaptcha-error"},this.state.validationErrors.recaptcha),u.a.createElement(F.a,{key:this.state.recaptchaInstanceId,publicKey:k.a.get("recaptcha_key"),size:"invisible",ref:this.setCaptchaRef,onChange:this.onRecapChange,onExpire:this.onRecapExpire})),u.a.createElement(P.a,_extends({},b,{onClick:this.onSubmitClick,type:"submit",className:g()(R.a.submitButton,(e={},_defineProperty(e,R.a.submitButtonCompact,"compact"===p),_defineProperty(e,R.a.hidden,l),e)),disabled:_,theme:"brand-purple",id:"".concat(this.idPrefix,"submit")}),f),!s&&u.a.createElement("p",{className:R.a.tos,dangerouslySetInnerHTML:{__html:"".concat(Object(h.b)("views.users.sessions.recaptcha_link")," ").concat(Object(h.b)("views.users.sessions.tos_link"))}}))),!c&&u.a.createElement(I.a,{signUp:!0,urlParams:{redirect:v}}))}}]),RegistrationForm}();U.propTypes={captureMarketingEmail:p.a.bool,currentPage:p.a.string,hideOauth:p.a.bool,hideUsername:p.a.bool,hideRecaptchaInfo:p.a.bool,hideSubmitButton:p.a.bool,disableFieldset:p.a.bool,markValidatedFields:p.a.bool,submitButtonProps:p.a.object,theme:p.a.string,location:p.a.shape({assign:p.a.func}),locationType:p.a.string,onSuccess:p.a.func,redirectUrl:p.a.string,ctaText:p.a.string},U.defaultProps={onSuccess:function redirectAfterLogin(e){var t=e.redirectTo;window.location.assign(Object(O.f)(t||Object(w.r)()))},submitButtonProps:{size:"large",theme:"brand-purple"},ctaText:Object(h.b)("views.users.registration.create_account_cta")},t.a=U}}]);
//# sourceMappingURL=80.b6596653179f58cfd184.chunk.js.map